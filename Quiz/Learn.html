<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NIFA Aircraft Rec</title>
    <link rel="stylesheet" href="../cleancss.css">
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../CSS/learn.css">
</head>
<body>
    <main>
        <!-- #Replace with DB-inserted aircraft -->
        <img src="../img/Aircraft/" alt="">
        <h2>Information about the aircraft:</h2>
        <ul>
            <li id="Manufacturer"><p></p></li>
            <li id="Model"><p></p></li>
            <li id="Altname"><p></p></li>
        </ul>
        <div class="dual">
            <!-- #Insert new aircraft, sequentially -->
            <div class="left" id="prev"><p>Previous</p></div>
            <div class="right" id="next"><p>Next</p></div>
        </div>
        <a href="Primary page.html" class="leave">
            <p>Go back</p>
        </a>
    </main>
    <script src="../script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const nextButton = document.getElementById('next');

            nextButton.addEventListener('click', function() {
                fetchAircraft();
            });

            // Initial fetch
            fetchAircraft();
        });

        async function fetchAircraft() {
            try {
                // Specify the correct port (1337) in the request URL
                const response = await fetch('http://127.0.0.1:1337/api/aircraft/next');
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const aircraft = await response.json();
                updateAircraftInfo(aircraft);
            } catch (error) {
                console.error('Failed to fetch aircraft:', error);
            }
        }

        function updateAircraftInfo(aircraft) {
            document.querySelector('img').src = "../img/Aircraft/" + aircraft.correctAircraft.imgSrc;
            document.querySelector('img').alt = aircraft.correctAircraft.model; // Assuming model is a good alt text
            document.getElementById('Manufacturer').querySelector('p').textContent = aircraft.correctAircraft.manufacturer;
            document.getElementById('Model').querySelector('p').textContent = aircraft.correctAircraft.model;
            document.getElementById('Altname').querySelector('p').textContent = aircraft.correctAircraft.altname;
        }
    </script>
</body>
</html>