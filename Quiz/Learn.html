<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NIFA Aircraft Rec</title>
    <link rel="stylesheet" href="../cleancss.css">
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../CSS/learn.css">
</head>
<body>
    <main>
        <!-- #Replace with DB-inserted aircraft -->
        <img src="../img/Aircraft/" alt="">
        <h2>Information about the aircraft:</h2>
        <ul>
            <li><p></p></li>
            <li><p></p></li>
            <li><p></p></li>
        </ul>
        <div class="dual">
            <!-- #Insert new aircraft, sequentially -->
            <div class="left" id="prev"><p>Previous</p></div>
            <div class="right" id="next"><p>Next</p></div>
        </div>
    </main>
    <script src="../script.js"></script>
    <script>
    let currentImageIndex = 0;
    let aircraftImages = [];
    let aircraftInfo = []; // New array to store aircraft information
    
    console.log("Script started");
    
    function loadSequentialAircraft() {
        console.log("loadSequentialAircraft function called");
        fetch('/api/sequential-question')
            .then(response => {
                console.log("Received response from fetch");
                return response.json();
            })
            .then(data => {
                console.log("Data parsed to JSON:", data);
                aircraftImages = [data.correctAircraft.imgSrc, ...data.wrongAnswers.map(answer => answer.imgSrc)];
                aircraftInfo = [data.correctAircraft.name, ...data.wrongAnswers.map(answer => answer.name)];
                console.log("Aircraft images:", aircraftImages);
                console.log("Aircraft info:", aircraftInfo);
                displayAircraftImage(currentImageIndex); // Display the first image after loading
                updateListItems(aircraftInfo); // Update list items with aircraft information
            })
            .catch(error => console.error('Error fetching aircraft images:', error));
    }
    
    function displayAircraftImage(index) {
        console.log(`displayAircraftImage called with index: ${index}`);
        const imgElement = document.querySelector('img');
        imgElement.src = `../img/Aircraft/${aircraftImages[index]}`;
        imgElement.alt = "Aircraft Image " + (index + 1);
        console.log(`Image src set to: ${imgElement.src}`);
    }
    
    function updateListItems(info) {
        console.log("updateListItems called with info:", info);
        const listItems = document.querySelectorAll('li p');
        info.forEach((item, index) => {
            if (listItems[index]) { // Check if the list item exists
                listItems[index].textContent = item; // Update the paragraph inside the list item
                console.log(`List item ${index} updated with: ${item}`);
            }
        });
    }
    
    document.addEventListener('DOMContentLoaded', loadSequentialAircraft);
    </script>
</body>
</html>